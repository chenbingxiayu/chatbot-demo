<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Dialogggg</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/botui/build/botui.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/botui/build/botui-theme-default.css" />
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.5.3/css/bootstrap.css" rel="stylesheet">
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.5.3/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
{% block body %}
<div class="container" style="background-color: #f7f8f8">
    <div class="jumbotron"  style="background-color: #f7f8f8">
        <h1 align="center" > UI暂时这样吧...</h1>
        <br>
        <br>
    </div>
    <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <div id="chatbox" style="height: 600px">
                <bot-ui style="background-color: aliceblue;"></bot-ui>
            </div>
        </div>
        <div class="col-md-2"></div>
    </div>
    <div class="jumbotron"  style="background-color: #f7f8f8">
        <br>
        <br>
    </div>
</div>

</body>
{% endblock body %}

{% load static %}
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="http://malsup.github.io/jquery.form.js"></script>
<script src="https://cdn.jsdelivr.net/vue/latest/vue.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/botui/build/botui.js"></script>
{% block javascript %}
<script>
    var botui = new BotUI('chatbox');
    var content = document.getElementsByTagName('chatbox');
    var user_input = 'default';

    function chatting (res) {
        botui.action.text({ // show 'text' action
                action: {
                    placeholder: 'Enter here'
                }
        }).then(function (res) { // get the result
            if(res.value != 'exit') {
                $(this).ajaxSubmit({
                  type: 'post',
                  url: "{% url 'auto_response' %}",
                  data:{
                      'post': res.value
                  },
                  success: function(data) {
                      response = data;
                      botui.message.add({
                        content: response
                      }).then(chatting())
                  }
                });
            } else {
                botui.message.add({
                    content: 'Bye bye!'
                });
            }
        });
    }

    botui.message.add({
        content: 'Hello from bot.'
    }).then(function () {
        chatting()
    })
</script>
{% endblock javascript %}
</html>